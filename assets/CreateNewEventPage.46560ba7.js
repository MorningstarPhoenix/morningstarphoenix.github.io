import{b as U,o as P,n as F,p as v,k as q,Q as k}from"./events-store.e01d7e35.js";import{Q as C}from"./QSeparator.83347d1c.js";import{a as A,Q as B,k as I}from"./QBtn.2c3c900e.js";import{c as J,h as R}from"./render.9917b090.js";import{r as b,S as T,v as L,G as W,o as z,h as N,g as j,z as Q,n as O,ac as G,Z as K,a0 as M,aa as Z,f as n,a2 as g}from"./index.1db63eb4.js";var $=J({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(c,{slots:h,emit:f}){const l=j(),s=b(null);let i=0;const r=[];function p(e){const m=typeof e=="boolean"?e:c.noErrorFocus!==!0,w=++i,x=(a,u)=>{f("validation"+(a===!0?"Success":"Error"),u)},D=a=>{const u=a.validate();return typeof u.then=="function"?u.then(d=>({valid:d,comp:a}),d=>({valid:!1,comp:a,err:d})):Promise.resolve({valid:u,comp:a})};return(c.greedy===!0?Promise.all(r.map(D)).then(a=>a.filter(u=>u.valid!==!0)):r.reduce((a,u)=>a.then(()=>D(u).then(d=>{if(d.valid===!1)return Promise.reject(d)})),Promise.resolve()).catch(a=>[a])).then(a=>{if(a===void 0||a.length===0)return w===i&&x(!0),!0;if(w===i){const{comp:u,err:d}=a[0];if(d!==void 0&&console.error(d),x(!1,u),m===!0){const E=a.find(({comp:_})=>typeof _.focus=="function"&&A(_.$)===!1);E!==void 0&&E.comp.focus()}}return!1})}function V(){i++,r.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function S(e){e!==void 0&&Q(e);const m=i+1;p().then(w=>{m===i&&w===!0&&(c.onSubmit!==void 0?f("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function y(e){e!==void 0&&Q(e),f("reset"),O(()=>{V(),c.autofocus===!0&&c.noResetFocus!==!0&&t()})}function t(){U(()=>{if(s.value===null)return;const e=s.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||s.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||s.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(s.value.querySelectorAll("[tabindex]"),m=>m.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}T(G,{bindComponent(e){r.push(e)},unbindComponent(e){const m=r.indexOf(e);m>-1&&r.splice(m,1)}});let o=!1;return L(()=>{o=!0}),W(()=>{o===!0&&c.autofocus===!0&&t()}),z(()=>{c.autofocus===!0&&t()}),Object.assign(l.proxy,{validate:p,resetValidation:V,submit:S,reset:y,focus:t,getValidationComponents:()=>r}),()=>N("form",{class:"q-form",ref:s,onSubmit:S,onReset:y},R(h.default))}});const H={class:"q-pa-md form center"},ne=K({__name:"CreateNewEventPage",setup(c){const h=P(),f=F(),l=b({title:"",description:"",author:f.currentLoggedUser,dateStart:new Date("January 1, 1997"),dateEnd:new Date("January 1, 1997"),location:"",created:new Date,coverImage:""}),s=b(""),i=b(""),r=b(""),p=b(""),V=()=>{let y=s.value+"T"+r.value+":00",t=i.value+"T"+p.value+":00";l.value.dateStart=new Date(Date.parse(y)),l.value.dateEnd=new Date(Date.parse(t)),h.eventsList.push(l.value),l.value={title:"",description:"",author:f.currentLoggedUser,dateStart:new Date("January 1, 1997"),dateEnd:new Date("January 1, 1997"),location:"",created:new Date,coverImage:""}},S=()=>{l.value={title:"",description:"",author:f.currentLoggedUser,dateStart:new Date("January 1, 1997"),dateEnd:new Date("January 1, 1997"),location:"",created:new Date,coverImage:""}};return(y,t)=>(M(),Z("div",H,[n($,{onSubmit:V,onReset:S,class:"q-gutter-md"},{default:g(()=>[n(v,{modelValue:l.value.title,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.title=o),type:"text",label:"What's the name of the event?",filled:""},null,8,["modelValue"]),n(v,{modelValue:l.value.description,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.description=o),type:"text",label:"Insert a description of the event",autogrow:"",filled:""},null,8,["modelValue"]),n(C,{spaced:"",inset:"",horizontal:"",dark:""}),n(q,null,{default:g(()=>[n(k,null,{default:g(()=>[n(v,{modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=o=>s.value=o),type:"date",label:"When will it begin?","stack-label":"",filled:""},null,8,["modelValue"]),n(v,{modelValue:r.value,"onUpdate:modelValue":t[3]||(t[3]=o=>r.value=o),type:"time",label:"At what time?","stack-label":"",filled:""},null,8,["modelValue"])]),_:1}),n(k,null,{default:g(()=>[n(v,{modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=o=>i.value=o),type:"date",label:"When will it end?","stack-label":"",filled:""},null,8,["modelValue"]),n(v,{modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=o=>p.value=o),type:"time",label:"At what time?","stack-label":"",filled:""},null,8,["modelValue"])]),_:1})]),_:1}),n(C,{spaced:"",inset:"",horizontal:"",dark:""}),n(v,{modelValue:l.value.location,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.location=o),type:"text",label:"Where will this event be?",filled:""},{prepend:g(()=>[n(B,{name:"mdi-map-marker-outline"})]),_:1},8,["modelValue"]),n(I,{color:"primary",icon:"check",label:"Create",type:"submit"}),n(I,{color:"primary",icon:"mdi-close",label:"Reset",type:"reset"})]),_:1})]))}});export{ne as default};
